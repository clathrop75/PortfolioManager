#Description of Stored Procedures
Following is a listing of the Stored Procedures in the database, what their purpose is and guidelines on usage.

##Transaction Stored Procedures
###spGetPortfolioSummary
This proc addresses the rather nasty problem of rolling up transactions into a concise portfolio view. The problem with this largely has to do with the calculation of the cost basis for a particular stock. The cost basis is how much it cost an investor to purchase the currently held amount of a particular stock. Within this calculation, any sales of stock have to be deducted from purchases on a First In-First Out (FIFO) basis. As such, the transactions simply cannot be summed. Instead each sale has to be deducted from the first buy order until that first order is expended. Then the sales order(s) move on consuming the second buy order until that is expended and so on until all sales have been deducted. From there, the total price of each remaining buy order are calculated and then aggregated to calculate the cost basis. While this could be handled at a different layer of the web app, doing so may result in a much larger transfer of data than necessary (or desirable) for users with larger and more active portfolios.

The proc takes a Username as an input and returns the a list of aggregations comprising the Company Name, Ticker Symbol, Last Trade Price, Total Shares, Cost Basis, Market Value, Total Gain and Return Percentage. These values are returned as floats and, therefore, will need to be appropriately handled in the UI. Total Shares should be left as is and Return Percentage just needs to have a '%' appended to it. The other numeric fields should be formatted as a currency and rounded to two decimals. If we can get it working so that Yahoo Finance data can be grabbed real-time from the browser (i.e. the last trade price), then this will be changed and the Market Value, Total Gain and Return Percentage will have to b calculated in the front-end.

###spGetTransactionsPaged
This proc avoids the issue of sending back all transactions for a particular user. The UI should use a paged interface for the grid rather than displaying all transactions as one time. So the UI makes a request to the API providing the page number, page size and user. The API then invokes the ORM which in turn calls this proc. It takes the username, page size and page number as parameters and returns the Company Name, Symbol, Transaction Type (0 = Sell, 1 = Buy), Transaction Date, Number of Shares, Price Per Share, Commission Amount and Notes.
